# Kytina_EPR_spectra_classification
# Применение методов машинного обучения для анализа спектров ЭПР оксидов металлов 
# Описание проекта
В данной работе решается задача классификации спектров электронного парамагнитного резонанса (ЭПР) нанокристаллических оксидов металлов с применением методов машинного обучения. На основе литературных данных и выполненного исследования нанооксидов металлов методом ЭПР были отобраны парамагнитные центры (радикалы), которые наиболее часто встречаются в нанокристаллических оксидах металлов. Поскольку реальные спектры ЭПР могут содержать шумы и артефакты, для обучения моделей использовался синтетический датасет, полученный путем симуляции экспериментальных спектров. Для решения задачи классификации были протестированы модели классического обучения (SVM, Random Forest, LGBM, CatBoost, XGBoost) и сверточные нейронные сети (ResNet18, Resnet34, Efficientnetb0, Efficientnetb3, Mobilenetv2). Была проведена предварительная предобработка данных, заключавшаяся в извлечении дополнительных признаков из спектральных данных для задач классического машинного обучения и применении непрерывного вейвлет-преобразования к одномерным признакам для нейросетевых моделей. Модели классического машинного обучения показали высокие средние значения метрик точности и f1-меры, для 7 классов радикалов данные значения равнялись 1 (или были близки к 1) .  Нейросетевые модели показали достаточно высокие значения метрик точности и f1-меры только после применения  непрерывного вейвлет-преобразования к массиву интенсивностей. Данный результат можно объяснить увеличением в несколько раз количества пространственных признаков , необходимых для эффективного обучения сверточных нейтронных сетей. Полученные результаты позволят автоматизировать процесс обработки спектров ЭПР, что значительно упростит и ускорит процесс работы ученых, выполняющих научные исследования в областях физики конденсированного состояния, а также будут способствовать популяризации метода ЭПР в научном сообществе.
# Данные
Спектры ЭПР записываются в виде массива, содержащего значения интенсивности I сигнала ЭПР в зависимости от значения магнитного поля H.
Реальные спектры наноструктур могут содержать аппаратные шумы, приборные «артефакты» (например, фоновые сигналы), поэтому было принято решение использовать синтетический датасет для обучения нейронной сети. Синтетический датасет представляет из себя спектры ЭПР, полученные путем численного моделирования экспериментальных спектров ЭПР в среде программирования MATLAB при помощи пакета функций «EasySpin»
# Модели 
1) Методы классического машинного обучения:
1.1) Метод опорных векторов с линейным,  нелинейным и полиномиальным ядрами
1.2) Модель Random forest 
Для увеличения точности расшифровки спектров методами классического машинного обучения были извлечены дополнительные признаки- количество пиков в спектре , минимальное и максимальное значения магнитного поля, в диапазоне между которыми наблюдаются сигналы ЭПР. Для извлечения признаков использовался метод  scipy.signal.find_peaks из библиотеки SciPy. 
1.3) LGBM
1.4) CatBoost
1.5) XGBoost
2) Нейросетевые модели :
Resnet18
Resnet34
Efficientnetb0
Efficientnetb3
Mobilenetv2
В качестве функции потерь была использована CrossEntropyLoss, в качестве метрик были использованы MultiClass Accuracy и MultiClass F1.
2.1) Нейросетевые модели для одномерных данных
Архитектуры используемых нейронных сетей были модифицированы для работы с одномерными данными. Операции для работы с двумерными данными заменены на аналогичные для работы с одномерными данными: (Conv2d -> Conv1d, MaxPool2d-> MaxPool1d, AdaptiveAvgPool2d ->  AdaptiveAvgPool1d). Таким образом, полученные модели идеально подходят для задач, где входными данными являются одномерные временные ряды или спектры.
2.2) Нейросетевые модели для двумерных данных, полученных путем применения непрерывного вейвлет-преобразования к одномерным признакам
Использовался вейвлет Морле. К каждому спектру в датасете применялось непрерывное вейвлет-преобразование. Масштаб вейвлета: от 1 до 128. В результате каждый спектр был преобразован в двумерный массив вейвлет-коэффициентов, в котором одной осью является масштаб, другой — позиция во времени (или магнитном поле). Двумерные массивы коэффициентов преобразовывались в трёхканальные изображения размером 224×224.
# Сравнительная таблица, демонстрирующая метрики качества для всех моделей

![Сравнительная таблица, демонстрирующая метрики качества для всех моделей](https://drive.google.com/uc?export=view&id=1mW0TzSqSI6qd7aictGw1hNvddl82Fl24)

# Проверка кода
Для получения основных результатов проекта Вы можете выполнить блокнот Model_for_reference_GitHub.ipynb (например, в Google Colab или Яндекс Датасфере) из папки notebooks.
Данный проект был выполнен на JupyterLab в сервисе Яндекс Датасфера.
